$button--m--font-size: $base-font-size; // 14
$button--m--icon-size: 18px;

$button--s--font-size: $button--m--font-size - 2; // 12
$button--s--icon-size: 16px;

$button--l--font-size: $button--m--font-size + 2; // 16
$button--l--icon-size: 20px;

$button--xl--font-size: $button--m--font-size + 6; // 20

$button--default-color: #333;
$button--border-radius: 4px;
$button--border-size: 1px;

$button--height-ratio: 2.5;
$button--horiz-padding-ratio: 0.5; //1.3;
$button--min-width-ratio: 6;
$button--inside-padding-ratio: 0.2;

$button--primary--color: #fff;
$button--primary--bg-color: #2a79ff;
$button--secondary--color: #333;
//$button--m--height: roundEven($button--m--font-size * $button--height-ratio);
//$button--m--padding-sides: roundEven($button--m--font-size * 1.2);
//$button--m--padding: round(($button--m--height - (2 * $button--border-size) - $button--m--font-size)/2);

@function buttonHeight($font-size) {
    @return roundEven($font-size * $button--height-ratio);
}

@function buttonVertPadding($button-height, $line-height) {
    @return round(($button-height - $line-height)/2);
}

@function buttonHorizPadding($button-height) {
    @return round($button-height * $button--horiz-padding-ratio);
}

@function buttonMinWidth($font-size) {
    @return roundEven($font-size * $button--min-width-ratio);
}

// M size
$button--m--height: buttonHeight($button--m--font-size);
$button--m--vert-padding: buttonVertPadding($button--m--height, $button--m--icon-size);
$button--m--horiz-padding: buttonHorizPadding($button--m--height);
$button--m--min-width: buttonMinWidth($button--m--font-size);

.var-dump--button-m-font-size:before {content: "#{$button--m--font-size}";}
.var-dump--button-m-height:before {content: "#{$button--m--height}";}
.var-dump--button-m-horiz-padding:before {content: "#{$button--m--horiz-padding}";}
.var-dump--button-m-min-width:before {content: "#{$button--m--min-width}";}

.var-info--button-m-horiz-padding {width: $button--m--horiz-padding;}
.var-info--button-m-height {height: $button--m--height;}

// S size
$button--s--height: buttonHeight($button--s--font-size);
$button--s--vert-padding: buttonVertPadding($button--s--height, $button--s--icon-size);
$button--s--horiz-padding: buttonHorizPadding($button--s--height);
$button--s--min-width: buttonMinWidth($button--s--font-size);

.var-dump--button-s-font-size:before {content: "#{$button--s--font-size}";}
.var-dump--button-s-height:before {content: "#{$button--s--height}";}
.var-dump--button-s-horiz-padding:before {content: "#{$button--s--horiz-padding}";}
.var-dump--button-s-min-width:before {content: "#{$button--s--min-width}";}
.var-info--button-s-horiz-padding {width: $button--s--horiz-padding;}
.var-info--button-s-height {height: $button--s--height;}

// L size
$button--l--height: buttonHeight($button--l--font-size);
$button--l--vert-padding: buttonVertPadding($button--l--height, $button--l--icon-size);
$button--l--horiz-padding: buttonHorizPadding($button--l--height);
$button--l--min-width: buttonMinWidth($button--l--font-size);

.var-dump--button-l-font-size:before {content: "#{$button--l--font-size}";}
.var-dump--button-l-height:before {content: "#{$button--l--height}";}
.var-dump--button-l-horiz-padding:before {content: "#{$button--l--horiz-padding}";}
.var-dump--button-l-min-width:before {content: "#{$button--l--min-width}";}
.var-info--button-l-horiz-padding {width: $button--l--horiz-padding;}
.var-info--button-l-height {height: $button--l--height;}


@mixin buttonSize($font-size) {
    $h: roundEven($font-size * $button--height-ratio);
    // $pv: round(($h - (2 * $button--border-size) - $font-size)/2);
    $pv: round(($h - $base-icon-size)/2);
    $ph: round($h * $button--horiz-padding-ratio);

    font-size: $font-size;
    height: $h;
    //padding: ($pv - 1px) (roundEven($font-size * 1.2)) ($pv + 1px);
    padding: $pv $ph;
    min-width: roundEven($font-size * $button--min-width-ratio);

    &:active {
        //padding: $pv (roundEven($font-size * 1.2)) $pv;
        padding-top: ($pv + 1);
        padding-bottom: ($pv - 1);
    }

    &.mtr-btn--loading::before {
        width: $font-size;
        height: $font-size;
    }
}

@mixin buttonFlat() {
    min-width: 0;
    padding-right: 0;
    padding-left: 0;
    border-color: transparent;
    background-color: transparent;
}

@mixin buttonDisabled() {
    pointer-events: none;
    cursor: default;
}

// ============================================================

// Default (с рамкой)
.mtr-btn {
    background-color: rgba(226, 17, 32, 0.1);
    color: #d82e03;
    border: none; // $button--border-size solid $button--default-color;
    border-radius: $button--border-radius;
    //line-height: $base-icon-size;

    > * {
        vertical-align: top;
    }

    span {
        height: $base-icon-size;
        line-height: $base-icon-size;
        display: inline-block;
    }

    &.mtr-btn--loading::before {
        border-color: transparent $button--default-color $button--default-color $button--default-color;
    }
}

a.mtr-btn {
    &:hover, &:active, &:visited, &:focus {
        text-decoration: none;
    }
}

//.mtr-btn--has-icon {
//    display: -ms-flexbox;
//    display: flex;
//    -ms-flex-align: center;
//    align-items: center;
//}

// Состояния
// ---------
// Normal
// Hover
// Focus
// Active
// Disabled
// Loading

$buttonSizes: (
    's': (
        'font-size': $base-font-size - 2,
        'icon-size': 16px
    ),
    'm': (
        'font-size': $base-font-size,
        'icon-size': 18px
    ),
    'l': (
        'font-size': $base-font-size + 2,
        'icon-size': 20px
    ),
);

@each $sizeCode, $v in $buttonSizes {
    $tmpFontSize: map-get($v, 'font-size');
    $tmpIconSize: map-get($v, 'icon-size');
    $tmpHeight: roundEven($tmpFontSize * $button--height-ratio);
    $tmpVertPadding: round(($tmpHeight - $tmpIconSize)/2);

    .mtr-btn--#{$sizeCode} {
        font-size: map-get($v, 'font-size');
        height: $tmpHeight;
        padding: $tmpVertPadding round($tmpHeight * $button--horiz-padding-ratio);
        min-width: roundEven($tmpFontSize * $button--min-width-ratio);
        line-height: $tmpIconSize;

        &:active {
            padding-top: ($tmpVertPadding + 1);
            padding-bottom: ($tmpVertPadding - 1);
        }

        > * ~ * {
            margin-left: round($tmpHeight * $button--inside-padding-ratio);
        }

        span {
            height: $tmpIconSize;
            line-height: $tmpIconSize;
            display: inline-block;
        }

        .mtr-btn__icon {
            width: $tmpIconSize;
            height: $tmpIconSize;
            display: inline-block;
        }
    }
}

// Размеры
// ---------
// Normal (medium)
//.mtr-btn--m {
//    // @include buttonSize($button--m--font-size);
//    font-size: $button--m--font-size;
//    height: $button--m--height;
//    padding: $button--m--vert-padding $button--m--horiz-padding;
//    min-width: $button--m--min-width;
//    line-height: $button--m--icon-size;
//
//    &:active {
//        padding-top: ($button--m--vert-padding + 1);
//        padding-bottom: ($button--m--vert-padding - 1);
//    }
//
//    span {
//        height: $button--m--icon-size;
//        line-height: $button--m--icon-size;
//        display: inline-block;
//    }
//
//    .mtr-btn__icon {
//        width: $button--m--icon-size;
//        height: $button--m--icon-size;
//        display: inline-block;
//        margin-right: ($button--m--icon-size/2);
//    }
//}
//
//// Small
//.mtr-btn--s {
//    // @include buttonSize($button--s--font-size);
//    font-size: $button--s--font-size;
//    height: $button--s--height;
//    padding: $button--s--vert-padding $button--s--horiz-padding;
//    min-width: $button--s--min-width;
//    line-height: $button--s--icon-size;
//
//    &:active {
//        padding-top: ($button--s--vert-padding + 1);
//        padding-bottom: ($button--s--vert-padding - 1);
//    }
//
//    span {
//        height: $button--s--icon-size;
//        line-height: $button--s--icon-size;
//        display: inline-block;
//    }
//
//    .mtr-btn__icon {
//        width: $button--s--icon-size;
//        height: $button--s--icon-size;
//        display: inline-block;
//        margin-right: ($button--s--icon-size/2);
//    }
//}
//
//// Large
//.mtr-btn--l {
//    // @include buttonSize($button--l--font-size);
//    font-size: $button--l--font-size;
//    height: $button--l--height;
//    padding: $button--l--vert-padding $button--l--horiz-padding;
//    min-width: $button--l--min-width;
//    line-height: $button--l--icon-size;
//
//    &:active {
//        padding-top: ($button--l--vert-padding + 1);
//        padding-bottom: ($button--l--vert-padding - 1);
//    }
//
//    span {
//        height: $button--l--icon-size;
//        line-height: $button--l--icon-size;
//        display: inline-block;
//    }
//
//    .mtr-btn__icon {
//        width: $button--l--icon-size;
//        height: $button--l--icon-size;
//        display: inline-block;
//        margin-right: ($button--l--icon-size/2);
//    }
//}

// Extra Large
.mtr-btn--xl {
    @include buttonSize($button--xl--font-size);

    .mtr-btn__icon {
        width: 24px;
        height: 24px;
        margin-right: 8px;
    }
}


// Типы
// после размеров!
// ---------

// Primary (без рамки, синяя)
.mtr-btn--primary {
    color: $button--primary--color;
    border-color: $button--primary--bg-color;
    background-color: $button--primary--bg-color;

    &:hover {
        border-color: #336eea;
        background-color: #336eea;
    }

    &:active {
        border-color: #3562d5;
        background-color: #3562d5;
    }

    &.mtr-btn--loading::before {
        border-color: transparent #fff #fff #fff;
    }

    &.mtr-btn--disabled, &[disabled] {
        color: $button--primary--color;
    }
}

a.mtr-btn--primary {
    &:hover, &:active, &:visited, &:focus {
        color: $button--primary--color;
    }
}

.mtr-btn--primary-bordered {
    color: $button--primary--bg-color;
    border-color: #5594ff;
    background-color: transparent;

    &:hover {
        background-color: #f7faff;
    }

    &:active {
        background-color: #f3f7ff;
    }

    &.mtr-btn--loading::before {
        border-color: transparent $button--primary--bg-color $button--primary--bg-color $button--primary--bg-color;
    }

    &.mtr-btn--disabled, &[disabled] {
        color: $button--primary--bg-color;
    }
}

a.mtr-btn--primary-bordered {
    &:hover, &:active, &:visited, &:focus {
        color: $button--primary--bg-color;
    }
}

.mtr-btn--primary-flat {
    @include buttonFlat;
    color: $button--primary--bg-color;

    &:hover {
        color: #336eea;
    }

    &:active {
        color: #3562d5;
    }

    &.mtr-btn--loading::before {
        border-color: transparent $button--primary--bg-color $button--primary--bg-color $button--primary--bg-color;
    }

    &.mtr-btn--disabled, &[disabled] {
        color: $button--primary--bg-color;
    }
}

a.mtr-btn--primary-flat {
    &:visited, &:focus {
        color: $button--primary--bg-color;
    }
}


// Secondary (без рамки, серая)
.mtr-btn--secondary {
    color: $button--secondary--color;
    // border-color: #f5f5f5;
    background-color: hsla(0, 0%, 96%, 1);

    &:hover {
        // border-color: #f0f0f0;
        background-color: hsla(0, 0%, 94%, 1);
    }

    &:active {
        // border-color: #ebebeb;
        background-color: hsla(0, 0%, 92%, 1);
    }

    &.mtr-btn--loading::before {
        border-color: transparent #333 #333 #333;
    }

    &.mtr-btn--disabled, &[disabled] {
        color: $button--secondary--color;
    }
}

.mtr-btn--secondary-bordered {
    color: $button--secondary--color;
    border-color: #cccccc;
    background-color: transparent;

    &:hover {
        background-color: #fafafa;
    }

    &:active {
        background-color: #f5f5f5;
    }

    &.mtr-btn--loading::before {
        border-color: transparent #333 #333 #333;
    }

    &.mtr-btn--disabled, &[disabled] {
        color: $button--secondary--color;
    }
}

.mtr-btn--secondary-flat {
    @include buttonFlat;
    color: #999;

    &:hover {
        color: #666;
    }

    &:active {
        color: #333;
    }

    &.mtr-btn--loading::before {
        border-color: transparent #999 #999 #999;
    }

    &.mtr-btn--disabled, &[disabled] {
        color: #999;
    }
}

// Success
// Danger
.mtr-btn--danger {
    color: #ffffff;
    border-color: #d92929;
    background-color: #d92929;

    &:hover {
        border-color: #c71414;
        background-color: #c71414;
    }

    &:active {
        border-color: #b80d0d;
        background-color: #b80d0d;
    }

    &.mtr-btn--loading::before {
        border-color: transparent #fff #fff #fff;
    }

    &.mtr-btn--disabled, &[disabled] {
        color: #fff;
    }
}

.mtr-btn--danger-bordered {
    color: #d92929;
    border-color: #e15454;
    background-color: transparent;

    &:hover {
        background-color: #fef7f7;
    }

    &:active {
        background-color: #fdf2f2;
    }

    &.mtr-btn--loading::before {
        border-color: transparent #d92929 #d92929 #d92929;
    }

    &.mtr-btn--disabled, &[disabled] {
        color: #d92929;
    }
}

.mtr-btn--danger-flat {
    @include buttonFlat;
    color: #d92929;

    &:hover {
        color: #c71414;
    }

    &:active {
        color: #d92929;
    }

    &.mtr-btn--loading::before {
        border-color: transparent #d92929 #d92929 #d92929;
    }

    &.mtr-btn--disabled, &[disabled] {
        color: #d92929;
    }
}

// Pay
.mtr-btn--pay { // #ffd54b, #ffbb39
    color: #404040;
    border-color: #ffd54b;
    background: #ffd54b;
}

// Link (без заливки)



// Loading
// идет после всех дизайнов кнопок, чтобы перебивать цвет
.mtr-btn--loading {
    opacity: 1;
    position: relative;
    color: transparent; // скрываем текст кнопки
    @include buttonDisabled();

    &::before {
        display: block;
        content: '';
        box-sizing: border-box;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        margin: auto;
        border-radius: 100%;
        border: 2px solid transparent;
        width: 20px;
        height: 20px;
        animation: spinner 0.6s linear infinite;
    }
}

// Disabled
// идет после всех дизайнов кнопок, чтобы перебивать всё
.mtr-btn--disabled, .mtr-btn[disabled] {
    opacity: 0.4;
    position: static;
    @include buttonDisabled();

    &::before {
        display: none;
    }
}